<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Economics Explained Through a Taco Stand</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --color-light: #e0ead3;
            --color-light-med: #b5c89e;
            --color-med: #90a872;
            --color-dark-med: #698a41;
            --color-dark: #365a0a;
            --color-copper: #b87333;
            --color-dark-blue: #003366;
            --color-text: #333333;
            --color-white: #ffffff;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--color-light);
            color: var(--color-text);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Header Styles */
        header {
            background: linear-gradient(to right, var(--color-dark), var(--color-dark-med));
            color: white;
            padding: 30px 0;
            border-bottom: 5px solid var(--color-copper);
        }
        
        .header-content {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: space-between;
        }
        
        .book-cover {
            flex: 0 0 250px;
            margin-right: 40px;
        }
        
        .book-cover img {
            width: 100%;
            border-radius: 8px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            border: 5px solid var(--color-copper);
        }
        
        .header-text {
            flex: 1;
            min-width: 300px;
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 15px;
            color: var(--color-white);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .tagline {
            font-size: 1.4rem;
            color: var(--color-light);
            margin-bottom: 20px;
            font-style: italic;
        }
        
        /* Summary Section */
        .summary-section {
            background-color: var(--color-white);
            padding: 50px 0;
            border-bottom: 3px solid var(--color-light-med);
        }
        
        h2 {
            color: var(--color-dark-blue);
            font-size: 2.2rem;
            margin-bottom: 25px;
            border-bottom: 3px solid var(--color-copper);
            padding-bottom: 10px;
            display: inline-block;
        }
        
        .summary-content {
            font-size: 1.2rem;
            line-height: 1.8;
            margin-bottom: 30px;
        }
        
        /* Author & Purchase Section */
        .author-purchase {
            background-color: var(--color-light-med);
            padding: 40px 0;
            display: flex;
            flex-wrap: wrap;
            gap: 40px;
        }
        
        .author-info, .purchase-info {
            flex: 1;
            min-width: 300px;
            background-color: var(--color-white);
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .author-info h3, .purchase-info h3 {
            color: var(--color-dark-blue);
            margin-bottom: 20px;
            font-size: 1.8rem;
        }
        
        .author-name {
            color: var(--color-copper);
            font-weight: bold;
            font-size: 1.4rem;
            margin-bottom: 10px;
        }
        
        .contact-btn, .buy-btn {
            display: inline-block;
            background-color: var(--color-copper);
            color: white;
            padding: 12px 25px;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            margin-top: 15px;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            font-size: 1.1rem;
        }
        
        .contact-btn:hover, .buy-btn:hover {
            background-color: var(--color-dark-blue);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .buy-btn {
            background-color: var(--color-dark);
        }
        
        /* Interactive Section */
        .interactive-section {
            padding: 60px 0;
            background-color: var(--color-white);
        }
        
        .section-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .interactive-container {
            display: flex;
            flex-wrap: wrap;
            gap: 40px;
            margin-bottom: 50px;
        }
        
        .controls-panel {
            flex: 1;
            min-width: 300px;
            background-color: var(--color-light);
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .graph-container {
            flex: 1;
            min-width: 300px;
            background-color: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
        }
        
        .slider-container {
            margin-bottom: 30px;
        }
        
        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .slider-description {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
            margin-bottom: 15px;
        }
        
        .slider {
            width: 100%;
            height: 10px;
            border-radius: 5px;
            background: var(--color-light-med);
            outline: none;
            -webkit-appearance: none;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: var(--color-copper);
            cursor: pointer;
            border: 2px solid var(--color-dark-blue);
        }
        
        .economics-principles {
            margin-top: 30px;
            background-color: var(--color-white);
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid var(--color-dark-med);
        }
        
        .economics-principles h4 {
            color: var(--color-dark-blue);
            margin-bottom: 15px;
        }
        
        .principles-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            font-size: 0.9rem;
        }
        
        .demand-principles, .supply-principles {
            padding: 10px;
            background-color: var(--color-light);
            border-radius: 5px;
        }
        
        .demand-principles h5, .supply-principles h5 {
            color: var(--color-dark);
            margin-bottom: 8px;
        }
        
        .demand-principles ul, .supply-principles ul {
            padding-left: 20px;
        }
        
        .demand-principles li, .supply-principles li {
            margin-bottom: 5px;
        }
        
        /* Graph Styles */
        .graph-wrapper {
            flex: 1;
            position: relative;
            min-height: 300px;
        }
        
        .chart-container {
            width: 100%;
            height: 300px;
            position: relative;
        }
        
        .graph-labels {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 10px;
            margin-bottom: 20px;
        }
        
        .demand-label, .supply-label {
            font-weight: bold;
            display: flex;
            align-items: center;
        }
        
        .demand-label:before, .supply-label:before {
            content: '';
            display: inline-block;
            width: 20px;
            height: 3px;
            margin-right: 8px;
        }
        
        .demand-label:before {
            background-color: var(--color-dark-blue);
        }
        
        .supply-label:before {
            background-color: var(--color-copper);
        }
        
        .feedback-box {
            background-color: var(--color-light-med);
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            font-style: italic;
            border-left: 4px solid var(--color-copper);
        }
        
        .equilibrium-explanation {
            background-color: var(--color-light);
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-size: 0.95rem;
            border: 1px dashed var(--color-dark-med);
        }
        
        /* Shock Events */
        .shock-events {
            background-color: var(--color-light);
            padding: 40px 0;
            text-align: center;
        }
        
        .shock-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin: 30px 0;
        }
        
        .shock-btn {
            background-color: var(--color-med);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .shock-btn:hover {
            background-color: var(--color-dark-med);
            transform: translateY(-5px);
        }
        
        .shock-explanation {
            background-color: var(--color-white);
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            display: none;
        }
        
        /* Game Section */
        .game-section {
            padding: 60px 0;
            background-color: var(--color-white);
        }
        
        .game-prompt {
            background-color: var(--color-dark-blue);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            font-size: 1.3rem;
        }
        
        .game-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .game-option {
            background-color: var(--color-light);
            padding: 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .game-option:hover {
            background-color: var(--color-light-med);
            border-color: var(--color-copper);
        }
        
        .game-reveal {
            background-color: var(--color-light);
            padding: 25px;
            border-radius: 10px;
            margin-top: 30px;
            display: none;
        }
        
        /* Footer */
        footer {
            background-color: var(--color-dark);
            color: white;
            padding: 30px 0;
            text-align: center;
        }
        
        .footer-content {
            max-width: 800px;
            margin: 0 auto;
        }
        
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            .book-cover {
                margin-right: 0;
                margin-bottom: 30px;
                flex: 0 0 auto;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .tagline {
                font-size: 1.2rem;
            }
            
            .principles-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Header with Book Cover -->
    <header>
        <div class="container header-content">
            <div class="book-cover">
                <!-- Book cover image - using your provided filename -->
                <img src="taconomicscover.jpg" alt="Economics Explained Through a Taco Stand" onerror="this.onerror=null; this.src='https://placehold.co/250x350/003366/b87333?text=Book+Cover&font=montserrat'">
            </div>
            <div class="header-text">
                <h1>Economics Explained Through a Taco Stand</h1>
                <p class="tagline">Learn Microeconomics One Taco at a Time</p>
                <p style="font-size: 1.2rem;">A deliciously simple introduction to economics where every concept is explained through the familiar lens of running a taco business. Perfect for students, curious minds, and anyone who's ever wondered how the economy really works.</p>
            </div>
        </div>
    </header>

    <!-- Book Summary Section -->
    <section class="summary-section">
        <div class="container">
            <h2>About the Book</h2>
            <div class="summary-content">
                <p>"Economics Explained Through a Taco Stand" transforms complex economic principles into digestible, real-world scenarios that everyone can understand. Instead of dry textbooks and confusing graphs, you'll explore fundamental concepts through the everyday challenges of running a taco business.</p>
                <p>This engaging guide covers essential microeconomics topics including supply and demand, market equilibrium, production costs, pricing strategies, and competitive markets—all through the lens of taco production and sales. Whether you're a student struggling with economic theory, a small business owner, or simply a curious mind, this book makes economics accessible, practical, and even fun.</p>
                <p>Author Sergio Nieto breaks down intimidating economic jargon into plain language, using the taco stand as a consistent, relatable framework. By the end of this book, you'll not only understand key economic concepts but also see how they play out in everyday life and business decisions.</p>
            </div>
        </div>
    </section>

    <!-- Author & Purchase Section -->
    <section class="author-purchase">
        <div class="container" style="display: flex; flex-wrap: wrap; gap: 40px;">
            <div class="author-info">
                <h3>About the Author</h3>
                <p class="author-name">Sergio Nieto</p>
                <p>Sergio Nieto is an economics educator with over 15 years of experience teaching microeconomics at the university level. Frustrated with how economics is traditionally taught, he developed a unique approach that uses everyday scenarios to explain complex concepts.</p>
                <p>His "Taco Stand Economics" method has been featured in educational conferences and has helped thousands of students grasp economic fundamentals. Sergio is available for speaking engagements, conferences, and workshops on Economics and Economic History.</p>
                <a href="mailto:sergio@tacostandeconomics.com" class="contact-btn">Contact for Conferences</a>
            </div>
            
            <div class="purchase-info">
                <h3>Get Your Copy Today</h3>
                <p>Available in paperback, hardcover, and ebook formats. Perfect for:</p>
                <ul style="margin: 15px 0 15px 20px;">
                    <li>Economics students seeking a clearer understanding</li>
                    <li>Teachers looking for engaging teaching materials</li>
                    <li>Small business owners wanting to understand market dynamics</li>
                    <li>Anyone curious about how the economy works</li>
                </ul>
                <p>Use the interactive tools below to experience the "Taco Stand Economics" approach before you buy!</p>
                <a href="https://www.amazon.com/Economics-Explained-Through-Taco-Stand/dp/XXXXXX" target="_blank" class="buy-btn">Buy on Amazon</a>
            </div>
        </div>
    </section>

    <!-- Interactive Supply & Demand Section -->
    <section class="interactive-section">
        <div class="container">
            <div class="section-header">
                <h2>Interactive Taco Economics</h2>
                <p>Adjust the sliders to see how supply and demand affect price and quantity in a taco market</p>
            </div>
            
            <div class="interactive-container">
                <div class="controls-panel">
                    <h3>Market Controls</h3>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>Price per Taco</span>
                            <span id="price-value">$4.00</span>
                        </div>
                        <p class="slider-description">Adjust the price you charge for each taco</p>
                        <input type="range" min="1" max="7" value="4" step="0.5" class="slider" id="price-slider">
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>Demand Shift (More/Fewer Customers)</span>
                            <span id="demand-value">Neutral</span>
                        </div>
                        <p class="slider-description">Move right: More customers. Move left: Fewer customers.</p>
                        <input type="range" min="-3" max="3" value="0" class="slider" id="demand-slider">
                        <div class="slider-ticks" style="display: flex; justify-content: space-between; margin-top: 5px; font-size: 0.8rem;">
                            <span>Fewer</span>
                            <span>Neutral</span>
                            <span>More</span>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>Supply Shift (Workers/Ingredients)</span>
                            <span id="supply-value">Neutral</span>
                        </div>
                        <p class="slider-description">Move right: More capacity. Move left: Shortage.</p>
                        <input type="range" min="-3" max="3" value="0" class="slider" id="supply-slider">
                        <div class="slider-ticks" style="display: flex; justify-content: space-between; margin-top: 5px; font-size: 0.8rem;">
                            <span>Shortage</span>
                            <span>Neutral</span>
                            <span>More Capacity</span>
                        </div>
                    </div>
                    
                    <div class="equilibrium-explanation">
                        <p><strong>Key Concept:</strong> The <em>equilibrium price</em> is where the supply and demand curves intersect. At this price, the quantity of tacos customers want to buy equals the quantity you're willing to sell.</p>
                    </div>
                    
                    <div class="economics-principles">
                        <h4>Economic Principles</h4>
                        <div class="principles-grid">
                            <div class="demand-principles">
                                <h5>Demand Shifts Right (Increase)</h5>
                                <ul>
                                    <li>More customers</li>
                                    <li>Higher income</li>
                                    <li>Price of substitutes rises</li>
                                    <li>Tastes & preferences increase</li>
                                </ul>
                            </div>
                            <div class="supply-principles">
                                <h5>Supply Shifts Right (Increase)</h5>
                                <ul>
                                    <li>More workers</li>
                                    <li>Better technology</li>
                                    <li>Lower ingredient costs</li>
                                    <li>Good weather conditions</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="graph-container">
                    <h3>Supply & Demand Graph</h3>
                    <div class="graph-wrapper">
                        <div class="chart-container">
                            <canvas id="economics-chart"></canvas>
                        </div>
                        <div class="graph-labels">
                            <div class="demand-label">Demand</div>
                            <div class="supply-label">Supply</div>
                        </div>
                    </div>
                    
                    <div class="feedback-box" id="feedback">
                        <!-- Feedback will be inserted here by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Shock Events Section -->
    <section class="shock-events">
        <div class="container">
            <div class="section-header">
                <h2>Market Shock Events</h2>
                <p>Click on events to see how real-world situations affect the taco market</p>
            </div>
            
            <div class="shock-buttons">
                <button class="shock-btn" data-event="avocado"><i class="fas fa-seedling"></i> Avocado Shortage</button>
                <button class="shock-btn" data-event="worker"><i class="fas fa-user-plus"></i> Hire Another Worker</button>
                <button class="shock-btn" data-event="football"><i class="fas fa-football-ball"></i> Football Game Nearby</button>
                <button class="shock-btn" data-event="rain"><i class="fas fa-cloud-rain"></i> Rainy Day</button>
            </div>
            
            <div class="shock-explanation" id="shock-explanation">
                <!-- Explanation will be inserted here by JavaScript -->
            </div>
        </div>
    </section>

    <!-- Game Section -->
    <section class="game-section">
        <div class="container">
            <div class="section-header">
                <h2>Test Your Understanding</h2>
                <p>Can you predict how the market will react?</p>
            </div>
            
            <div class="game-prompt" id="game-prompt">
                "You decide to raise your taco price by $1. What happens to your sales?"
            </div>
            
            <div class="game-options">
                <div class="game-option" data-answer="more">
                    <h4>More tacos sold</h4>
                    <p>Customers perceive higher quality and buy more</p>
                </div>
                <div class="game-option" data-answer="fewer">
                    <h4>Fewer tacos sold</h4>
                    <p>Some customers can't afford the higher price</p>
                </div>
                <div class="game-option" data-answer="same">
                    <h4>Same sales, higher profit</h4>
                    <p>Customers are loyal and don't mind paying more</p>
                </div>
            </div>
            
            <div class="game-reveal" id="game-reveal">
                <!-- Answer will be inserted here by JavaScript -->
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container footer-content">
            <h3>Economics Explained Through a Taco Stand</h3>
            <p>© 2023 Sergio Nieto. All rights reserved.</p>
            <p>This website accompanies the book "Economics Explained Through a Taco Stand"</p>
            <p style="margin-top: 20px; font-size: 0.9rem; color: var(--color-light-med);">For educational purposes only. Taco illustrations and concepts are proprietary.</p>
        </div>
    </footer>

    <script>
        // DOM Elements
        const priceSlider = document.getElementById('price-slider');
        const demandSlider = document.getElementById('demand-slider');
        const supplySlider = document.getElementById('supply-slider');
        const priceValue = document.getElementById('price-value');
        const demandValue = document.getElementById('demand-value');
        const supplyValue = document.getElementById('supply-value');
        const feedback = document.getElementById('feedback');
        const shockButtons = document.querySelectorAll('.shock-btn');
        const shockExplanation = document.getElementById('shock-explanation');
        const gameOptions = document.querySelectorAll('.game-option');
        const gameReveal = document.getElementById('game-reveal');
        
        // Chart.js variables
        let economicsChart;
        let equilibriumPrice = 4.0;
        let currentPrice = 4.0;
        let isAtEquilibrium = true;
        
        // Initialize the chart
        function initializeChart() {
            const ctx = document.getElementById('economics-chart').getContext('2d');
            
            // Destroy existing chart if it exists
            if (economicsChart) {
                economicsChart.destroy();
            }
            
            economicsChart = new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: [
                        {
                            label: 'Demand',
                            data: [],
                            borderColor: '#003366',
                            backgroundColor: 'transparent',
                            borderWidth: 3,
                            pointRadius: 0,
                            fill: false,
                            tension: 0,
                            borderDash: []
                        },
                        {
                            label: 'Supply',
                            data: [],
                            borderColor: '#b87333',
                            backgroundColor: 'transparent',
                            borderWidth: 3,
                            pointRadius: 0,
                            fill: false,
                            tension: 0,
                            borderDash: []
                        },
                        {
                            label: 'Equilibrium',
                            data: [],
                            backgroundColor: '#365a0a',
                            borderColor: '#365a0a',
                            pointRadius: 8,
                            pointHoverRadius: 10,
                            pointBorderWidth: 2,
                            pointBorderColor: '#ffffff',
                            showLine: false
                        },
                        {
                            label: 'Current Price',
                            data: [],
                            backgroundColor: '#ff4444',
                            borderColor: '#ff4444',
                            pointRadius: 6,
                            pointHoverRadius: 8,
                            pointBorderWidth: 2,
                            pointBorderColor: '#ffffff',
                            pointStyle: 'rectRot',
                            showLine: false
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false
                        }
                    },
                    scales: {
                        x: {
                            type: 'linear',
                            position: 'bottom',
                            title: {
                                display: true,
                                text: 'Quantity (Tacos per day)',
                                color: '#333333',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                }
                            },
                            min: 0,
                            max: 100,
                            grid: {
                                color: 'rgba(0,0,0,0.1)'
                            },
                            ticks: {
                                stepSize: 10,
                                callback: function(value) {
                                    return value;
                                }
                            }
                        },
                        y: {
                            type: 'linear',
                            title: {
                                display: true,
                                text: 'Price ($ per taco)',
                                color: '#333333',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                }
                            },
                            min: 0,
                            max: 8,
                            grid: {
                                color: 'rgba(0,0,0,0.1)'
                            },
                            ticks: {
                                stepSize: 1,
                                callback: function(value) {
                                    return '$' + value.toFixed(1);
                                }
                            }
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    }
                }
            });
            
            // Initial update
            updateChart();
        }
        
        // Calculate demand curve points
        function calculateDemandCurve(shift) {
            const points = [];
            // Base demand function: Q = 100 - 12.5*P
            // Shift moves the curve left/right: Q = 100 - 12.5*P + (shift * 15)
            
            for (let price = 0; price <= 8; price += 0.2) {
                let quantity = 100 - 12.5 * price + (shift * 15);
                
                // Only include points within graph bounds
                if (quantity >= 0 && quantity <= 100 && price >= 0 && price <= 8) {
                    points.push({x: quantity, y: price});
                }
            }
            
            return points;
        }
        
        // Calculate supply curve points
        function calculateSupplyCurve(shift) {
            const points = [];
            // Base supply function: Q = 12.5*P - 50
            // Shift moves the curve left/right: Q = 12.5*P - 50 + (shift * 15)
            
            for (let price = 0; price <= 8; price += 0.2) {
                let quantity = 12.5 * price - 50 + (shift * 15);
                
                // Only include points within graph bounds
                if (quantity >= 0 && quantity <= 100 && price >= 0 && price <= 8) {
                    points.push({x: quantity, y: price});
                }
            }
            
            return points;
        }
        
        // Find intersection of demand and supply curves
        function findEquilibrium(demandPoints, supplyPoints) {
            // Find closest points between demand and supply curves
            let minDistance = Infinity;
            let equilibriumPoint = {x: 50, y: 4.0};
            
            for (let i = 0; i < demandPoints.length; i++) {
                const demandPoint = demandPoints[i];
                
                for (let j = 0; j < supplyPoints.length; j++) {
                    const supplyPoint = supplyPoints[j];
                    
                    // Calculate distance between points
                    const dx = demandPoint.x - supplyPoint.x;
                    const dy = demandPoint.y - supplyPoint.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    
                    // Find points that are close in both price and quantity
                    if (distance < minDistance && Math.abs(demandPoint.y - supplyPoint.y) < 0.5) {
                        minDistance = distance;
                        // Use average of the two points for equilibrium
                        equilibriumPoint = {
                            x: (demandPoint.x + supplyPoint.x) / 2,
                            y: (demandPoint.y + supplyPoint.y) / 2
                        };
                    }
                }
            }
            
            return equilibriumPoint;
        }
        
        // Update the chart
        function updateChart() {
            const demandShift = parseInt(demandSlider.value);
            const supplyShift = parseInt(supplySlider.value);
            currentPrice = parseFloat(priceSlider.value);
            
            // Calculate curves based on shifts
            const demandPoints = calculateDemandCurve(demandShift);
            const supplyPoints = calculateSupplyCurve(supplyShift);
            
            // Find equilibrium point
            const equilibrium = findEquilibrium(demandPoints, supplyPoints);
            equilibriumPrice = equilibrium.y;
            
            // Check if current price equals equilibrium
            isAtEquilibrium = Math.abs(currentPrice - equilibriumPrice) < 0.1;
            
            // Update chart data
            economicsChart.data.datasets[0].data = demandPoints;
            economicsChart.data.datasets[1].data = supplyPoints;
            economicsChart.data.datasets[2].data = [equilibrium];
            
            // Current price marker (show at equilibrium quantity for clarity)
            const currentPricePoint = { x: equilibrium.x, y: currentPrice };
            economicsChart.data.datasets[3].data = [currentPricePoint];
            
            // Update chart
            economicsChart.update('none');
            
            // Update feedback
            updateFeedback();
        }
        
        // Update sliders and display
        function updateSliders() {
            // Update displayed values
            currentPrice = parseFloat(priceSlider.value);
            priceValue.textContent = '$' + currentPrice.toFixed(2);
            
            // Update demand slider label
            const demandVal = parseInt(demandSlider.value);
            if (demandVal < 0) {
                demandValue.textContent = Math.abs(demandVal) + ' level' + (Math.abs(demandVal) > 1 ? 's' : '') + ' fewer customers';
            } else if (demandVal > 0) {
                demandValue.textContent = demandVal + ' level' + (demandVal > 1 ? 's' : '') + ' more customers';
            } else {
                demandValue.textContent = 'Neutral';
            }
            
            // Update supply slider label
            const supplyVal = parseInt(supplySlider.value);
            if (supplyVal < 0) {
                supplyValue.textContent = Math.abs(supplyVal) + ' level' + (Math.abs(supplyVal) > 1 ? 's' : '') + ' shortage';
            } else if (supplyVal > 0) {
                supplyValue.textContent = supplyVal + ' level' + (supplyVal > 1 ? 's' : '') + ' more capacity';
            } else {
                supplyValue.textContent = 'Neutral';
            }
            
            // Update chart
            updateChart();
        }
        
        // Update feedback text
        function updateFeedback() {
            const demandShift = parseInt(demandSlider.value);
            const supplyShift = parseInt(supplySlider.value);
            
            let feedbackText = "";
            
            if (isAtEquilibrium) {
                feedbackText = `The taco market is in equilibrium. At $${equilibriumPrice.toFixed(2)} per taco, the quantity supplied matches the quantity demanded. This is the equilibrium price where the supply and demand curves intersect.`;
                
                if (demandShift !== 0 || supplyShift !== 0) {
                    feedbackText += ` The equilibrium has shifted due to market changes.`;
                    
                    if (demandShift > 0 && supplyShift === 0) {
                        feedbackText += ` Increased demand has raised the equilibrium price from $4.00 to $${equilibriumPrice.toFixed(2)}.`;
                    } else if (demandShift < 0 && supplyShift === 0) {
                        feedbackText += ` Decreased demand has lowered the equilibrium price from $4.00 to $${equilibriumPrice.toFixed(2)}.`;
                    } else if (supplyShift > 0 && demandShift === 0) {
                        feedbackText += ` Increased supply has lowered the equilibrium price from $4.00 to $${equilibriumPrice.toFixed(2)}.`;
                    } else if (supplyShift < 0 && demandShift === 0) {
                        feedbackText += ` Decreased supply has raised the equilibrium price from $4.00 to $${equilibriumPrice.toFixed(2)}.`;
                    } else if (demandShift > 0 && supplyShift > 0) {
                        feedbackText += ` Both demand and supply have increased. Quantity definitely increases, but the price effect depends on which increased more.`;
                    } else if (demandShift > 0 && supplyShift < 0) {
                        feedbackText += ` Demand increased but supply decreased. Price definitely increases, but the quantity effect is indeterminate.`;
                    }
                }
            } else {
                if (currentPrice > equilibriumPrice) {
                    feedbackText = `At $${currentPrice.toFixed(2)} (above the equilibrium price of $${equilibriumPrice.toFixed(2)}), quantity supplied exceeds quantity demanded. This creates a surplus - you have unsold tacos.`;
                } else {
                    feedbackText = `At $${currentPrice.toFixed(2)} (below the equilibrium price of $${equilibriumPrice.toFixed(2)}), quantity demanded exceeds quantity supplied. This creates a shortage - you sell out quickly.`;
                }
                
                // Add shift information
                if (demandShift > 0) {
                    feedbackText += ` Demand has increased (more customers).`;
                } else if (demandShift < 0) {
                    feedbackText += ` Demand has decreased (fewer customers).`;
                }
                
                if (supplyShift > 0) {
                    feedbackText += ` Supply has increased (more capacity).`;
                } else if (supplyShift < 0) {
                    feedbackText += ` Supply has decreased (shortage).`;
                }
            }
            
            feedback.innerHTML = `<p>"${feedbackText}"</p>`;
        }
        
        // Shock event handlers
        shockButtons.forEach(button => {
            button.addEventListener('click', function() {
                const event = this.getAttribute('data-event');
                let demandChange = 0;
                let supplyChange = 0;
                let explanation = "";
                
                switch(event) {
                    case 'avocado':
                        supplyChange = -2;
                        explanation = `<strong>Avocado Shortage:</strong> This increases your production costs and reduces how many tacos you can make. Supply decreases (shifts left), raising the equilibrium price. Customers pay more, and fewer tacos are sold overall. This demonstrates how input costs affect supply.`;
                        break;
                    case 'worker':
                        supplyChange = 2;
                        explanation = `<strong>Hire Another Worker:</strong> With more labor, you can produce more tacos at every price. Supply increases (shifts right), lowering the equilibrium price. Customers pay less, and more tacos are sold. This shows how production capacity affects supply.`;
                        break;
                    case 'football':
                        demandChange = 3;
                        explanation = `<strong>Football Game Nearby:</strong> More hungry fans want tacos. Demand increases (shifts right), raising the equilibrium price. At the original price, tacos would sell out quickly. The price rises until supply and demand are balanced again.`;
                        break;
                    case 'rain':
                        demandChange = -2;
                        explanation = `<strong>Rainy Day:</strong> Fewer people go out for tacos. Demand decreases (shifts left), lowering the equilibrium price. At the original price, you'd have unsold tacos. The price falls until the market clears.`;
                        break;
                }
                
                // Update sliders
                demandSlider.value = parseInt(demandSlider.value) + demandChange;
                supplySlider.value = parseInt(supplySlider.value) + supplyChange;
                
                // Clamp values
                demandSlider.value = Math.max(-3, Math.min(3, demandSlider.value));
                supplySlider.value = Math.max(-3, Math.min(3, supplySlider.value));
                
                // Update display
                updateSliders();
                
                // Show explanation
                shockExplanation.innerHTML = `<h4>${button.innerHTML}</h4><p>${explanation}</p>`;
                shockExplanation.style.display = 'block';
                shockExplanation.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            });
        });
        
        // Game option handlers
        gameOptions.forEach(option => {
            option.addEventListener('click', function() {
                const answer = this.getAttribute('data-answer');
                let revealText = "";
                let isCorrect = false;
                
                // Check answer
                if (answer === "fewer") {
                    revealText = "Correct! When you raise prices, some customers will buy fewer tacos or stop buying altogether. This is the law of demand: as price increases, quantity demanded decreases. This is shown as a movement along the demand curve (not a shift of the curve).";
                    isCorrect = true;
                } else {
                    revealText = "Not quite. While it's possible that perceived quality might increase or loyal customers might not mind, the basic economic principle is that when prices rise, quantity demanded typically falls. This is known as the law of demand and is shown as a movement along the demand curve.";
                    isCorrect = false;
                }
                
                // Display result
                gameReveal.innerHTML = `
                    <h3>${isCorrect ? "✅ Correct!" : "❌ Try Again"}</h3>
                    <p>${revealText}</p>
                    <p><strong>Economic Principle:</strong> This demonstrates the law of demand and the difference between a movement along the curve (price change) vs. a shift of the curve (other factors changing).</p>
                `;
                gameReveal.style.display = 'block';
                
                // Scroll to reveal
                gameReveal.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            });
        });
        
        // Initialize everything when page loads
        window.addEventListener('DOMContentLoaded', function() {
            initializeChart();
            updateSliders();
            
            // Add event listeners to sliders
            priceSlider.addEventListener('input', updateSliders);
            demandSlider.addEventListener('input', updateSliders);
            supplySlider.addEventListener('input', updateSliders);
        });
    </script>
</body>
</html>
